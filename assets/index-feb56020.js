(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))I(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const B of l.addedNodes)B.tagName==="LINK"&&B.rel==="modulepreload"&&I(B)}).observe(document,{childList:!0,subtree:!0});function i(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function I(s){if(s.ep)return;s.ep=!0;const l=i(s);fetch(s.href,l)}})();const u={apiKey:{}.VITE_FIREBASE_APIKEY||{}.FIREBASE_APIKEY,authDomain:{}.VITE_FIREBASE_AUTH_DOMAIN||{}.FIREBASE_AUTH_DOMAIN,projectId:{}.VITE_FIREBASE_PROJECT_ID||{}.FIREBASE_PROJECT_ID,storageBucket:{}.VITE_FIREBASE_STORAGE_BUCKET||{}.FIREBASE_STORAGE_BUCKET,messagingSenderId:{}.VITE_FIREBASE_MESSAGING_SENDER_ID||{}.FIREBASE_MESSAGING_SENDER_ID,appId:{}.VITE_FIREBASE_APP_ID||{}.FIREBASE_APP_ID,measurementId:{}.VITE_FIREBASE_MEASUREMENT_ID||{}.FIREBASE_MEASUREMENT_ID},S=u.apiKey&&u.authDomain&&u.projectId&&u.storageBucket&&u.messagingSenderId&&u.appId;S?(firebase.initializeApp(u),firebase.firestore()):console.warn("Firebase configuration incomplete. Leaderboard features will be disabled.");let t,r,o=0,E=!1,y=!1,a,d,c,p,f,m=30,g=!1,v=0,h=!1;window.onload=function(){b(),document.getElementById("startBtn").addEventListener("click",F),document.getElementById("restartBtn").addEventListener("click",M),document.getElementById("restartBtn").disabled=!0,c=document.getElementById("custom-cursor"),p=document.getElementById("board"),L(),x()};function b(){const e=document.getElementById("board");e.innerHTML="";for(let n=0;n<9;n++){let i=document.createElement("div");i.id=n.toString(),i.addEventListener("click",A),i.style.cssText="cursor: pointer; position: relative; z-index: 2;",e.appendChild(i)}}function L(){p.addEventListener("mouseenter",function(){c.style.display="block"}),p.addEventListener("mouseleave",function(){c.style.display="none"}),p.addEventListener("mousemove",function(e){c.style.left=e.clientX+"px",c.style.top=e.clientY+"px"}),p.addEventListener("click",function(){c.classList.remove("cursor-hit"),c.offsetWidth,c.classList.add("cursor-hit"),setTimeout(()=>{c.classList.remove("cursor-hit")},300)})}function T(){return Math.floor(Math.random()*9).toString()}function _(){if(!y||E)return;t&&(t.innerHTML="");let e=document.createElement("img");e.src="./assets/characterP_nor.png";let n=T();r&&r.id==n||(t=document.getElementById(n),t&&(t.appendChild(e),setTimeout(()=>{e.parentNode===t&&e.classList.add("pop-up")},10)))}function C(){if(!y||E)return;r&&(r.innerHTML="");let e=document.createElement("img");e.src="./assets/characterG_nor.png";let n=T();t&&t.id==n||(r=document.getElementById(n),r&&(r.appendChild(e),setTimeout(()=>{e.parentNode===r&&e.classList.add("pop-up")},10)))}function A(){if(E)return;let e=g?20:10;this==t?(o-=e,o<0&&(o=0),document.getElementById("score").innerText=o.toString(),t&&t.firstChild&&(t.firstChild.src="./assets/characterP_angry.png",setTimeout(()=>{t&&t.firstChild&&(t.firstChild.src="./assets/characterP_nor.png")},300))):this==r&&(r&&r.firstChild&&r.firstChild.src.includes("characterG_nor")?(o+=e,document.getElementById("score").innerText=o.toString(),r&&r.firstChild&&(r.firstChild.src="./assets/characterG_happy.png"),t&&t.firstChild&&(t.firstChild.src="./assets/characterP_angry.png",setTimeout(()=>{t&&t.firstChild&&(t.firstChild.src="./assets/characterP_nor.png")},300)),setTimeout(()=>{r&&r.firstChild&&(r.firstChild.src="./assets/characterG_nor.png")},1e3)):r&&r.firstChild&&r.firstChild.src.includes("characterG_happy")&&(o+=e,document.getElementById("score").innerText=o.toString(),t&&t.firstChild&&(t.firstChild.src="./assets/characterP_angry.png",setTimeout(()=>{t&&t.firstChild&&(t.firstChild.src="./assets/characterP_nor.png")},300)),setTimeout(()=>{r&&r.firstChild&&(r.firstChild.src="./assets/characterG_nor.png")},1e3)))}function F(){y||(y=!0,E=!1,g=!1,o=0,m=30,document.getElementById("score").innerText=o.toString(),document.getElementById("timer").innerText=m+"s",document.getElementById("startBtn").disabled=!0,document.getElementById("restartBtn").disabled=!1,a&&clearInterval(a),d&&clearInterval(d),f&&clearInterval(f),a=setInterval(_,1e3),d=setInterval(C,2e3),f=setInterval(()=>{m--,document.getElementById("timer").innerText=m+"s",m<=10&&!g&&R(),m<=0&&P()},1e3),t&&(t.innerHTML=""),r&&(r.innerHTML=""),t=null,r=null)}function R(){g=!0,a&&clearInterval(a),d&&clearInterval(d),a=setInterval(_,500),d=setInterval(C,1e3),document.getElementById("timer").innerText=m+"s FEVER!",document.getElementById("timer").style.color="#FFD700";let e=document.createElement("div");e.id="fever-notice",e.innerText="FEVER MODE! +20 points per hit!",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.backgroundColor="#FFD700",e.style.color="#000",e.style.padding="20px",e.style.borderRadius="10px",e.style.fontSize="24px",e.style.fontWeight="bold",e.style.zIndex="10000",e.style.boxShadow="0 0 20px rgba(255, 215, 0, 0.8)",document.body.appendChild(e),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},3e3)}function M(){a&&clearInterval(a),d&&clearInterval(d),f&&clearInterval(f),t&&(t.innerHTML=""),r&&(r.innerHTML=""),t=null,r=null,y=!1,E=!1,g=!1,h=!1,o=0,m=30,document.getElementById("score").innerText=o.toString(),document.getElementById("timer").innerText=m+"s",document.getElementById("timer").style.color="#e52521",document.getElementById("startBtn").disabled=!1,document.getElementById("restartBtn").disabled=!0,document.getElementById("add-score").style.display="none";let e=document.getElementById("fever-notice");e&&e.parentNode.removeChild(e)}function P(){a&&clearInterval(a),d&&clearInterval(d),f&&clearInterval(f),E=!0,v=o,document.getElementById("score").innerText="FINAL SCORE: "+o.toString(),document.getElementById("restartBtn").disabled=!1,h||(document.getElementById("add-score").style.display="block",document.getElementById("player-name").focus())}function x(){document.getElementById("save-score").addEventListener("click",N),db.collection("leaderboard").orderBy("score","desc").limit(10).onSnapshot(e=>{const n=[];e.forEach(i=>{n.push(i.data())}),G(n)},e=>{console.error("Error listening to leaderboard:",e)})}function G(e){const n=document.getElementById("leaderboard-body");n.innerHTML="";for(let i=0;i<Math.min(e.length,10);i++){const I=document.createElement("tr");I.innerHTML=`
            <td>${i+1}</td>
            <td>${e[i].name}</td>
            <td>${e[i].score}</td>
        `,n.appendChild(I)}}function N(){const e=document.getElementById("player-name"),n=e.value.trim();if(n===""){alert("Please enter your name");return}if(h){alert("Score already saved!");return}db.collection("leaderboard").add({name:n,score:v,timestamp:firebase.firestore.FieldValue.serverTimestamp()}).then(()=>{h=!0,document.getElementById("add-score").style.display="none",e.value="",alert("Score saved to global leaderboard!")}).catch(i=>{console.error("Error saving score to Firestore:",i),alert("Failed to save score. Please check Firestore security rules.")})}
