(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))p(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const E of l.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&p(E)}).observe(document,{childList:!0,subtree:!0});function i(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function p(s){if(s.ep)return;s.ep=!0;const l=i(s);fetch(s.href,l)}})();const L={apiKey:{}.FIREBASE_APIKEY,authDomain:"",projectId:"",storageBucket:"",messagingSenderId:"",appId:"",measurementId:""};firebase.initializeApp(L);const v=firebase.firestore();let t,r,o=0,f=!1,g=!1,a,d,c,y,u,m=30,h=!1,B=0,I=!1;window.onload=function(){x(),document.getElementById("startBtn").addEventListener("click",M),document.getElementById("restartBtn").addEventListener("click",_),document.getElementById("restartBtn").disabled=!0,c=document.getElementById("custom-cursor"),y=document.getElementById("board"),S(),N()};function x(){const e=document.getElementById("board");e.innerHTML="";for(let n=0;n<9;n++){let i=document.createElement("div");i.id=n.toString(),i.addEventListener("click",P),i.style.cssText="cursor: pointer; position: relative; z-index: 2;",e.appendChild(i)}}function S(){y.addEventListener("mouseenter",function(){c.style.display="block"}),y.addEventListener("mouseleave",function(){c.style.display="none"}),y.addEventListener("mousemove",function(e){c.style.left=e.clientX+"px",c.style.top=e.clientY+"px"}),y.addEventListener("click",function(){c.classList.remove("cursor-hit"),c.offsetWidth,c.classList.add("cursor-hit"),setTimeout(()=>{c.classList.remove("cursor-hit")},300)})}function C(){return Math.floor(Math.random()*9).toString()}function T(){if(!g||f)return;t&&(t.innerHTML="");let e=document.createElement("img");e.src="./assets/characterP_nor.png";let n=C();r&&r.id==n||(t=document.getElementById(n),t&&(t.appendChild(e),setTimeout(()=>{e.parentNode===t&&e.classList.add("pop-up")},10)))}function b(){if(!g||f)return;r&&(r.innerHTML="");let e=document.createElement("img");e.src="./assets/characterG_nor.png";let n=C();t&&t.id==n||(r=document.getElementById(n),r&&(r.appendChild(e),setTimeout(()=>{e.parentNode===r&&e.classList.add("pop-up")},10)))}function P(){if(f)return;let e=h?20:10;this==t?(o-=e,o<0&&(o=0),document.getElementById("score").innerText=o.toString(),t&&t.firstChild&&(t.firstChild.src="./assets/characterP_angry.png",setTimeout(()=>{t&&t.firstChild&&(t.firstChild.src="./assets/characterP_nor.png")},300))):this==r&&(r&&r.firstChild&&r.firstChild.src.includes("characterG_nor")?(o+=e,document.getElementById("score").innerText=o.toString(),r&&r.firstChild&&(r.firstChild.src="./assets/characterG_happy.png"),t&&t.firstChild&&(t.firstChild.src="./assets/characterP_angry.png",setTimeout(()=>{t&&t.firstChild&&(t.firstChild.src="./assets/characterP_nor.png")},300)),setTimeout(()=>{r&&r.firstChild&&(r.firstChild.src="./assets/characterG_nor.png")},1e3)):r&&r.firstChild&&r.firstChild.src.includes("characterG_happy")&&(o+=e,document.getElementById("score").innerText=o.toString(),t&&t.firstChild&&(t.firstChild.src="./assets/characterP_angry.png",setTimeout(()=>{t&&t.firstChild&&(t.firstChild.src="./assets/characterP_nor.png")},300)),setTimeout(()=>{r&&r.firstChild&&(r.firstChild.src="./assets/characterG_nor.png")},1e3)))}function M(){g||(g=!0,f=!1,h=!1,o=0,m=30,document.getElementById("score").innerText=o.toString(),document.getElementById("timer").innerText=m+"s",document.getElementById("startBtn").disabled=!0,document.getElementById("restartBtn").disabled=!1,a&&clearInterval(a),d&&clearInterval(d),u&&clearInterval(u),a=setInterval(T,1e3),d=setInterval(b,2e3),u=setInterval(()=>{m--,document.getElementById("timer").innerText=m+"s",m<=10&&!h&&F(),m<=0&&G()},1e3),t&&(t.innerHTML=""),r&&(r.innerHTML=""),t=null,r=null)}function F(){h=!0,a&&clearInterval(a),d&&clearInterval(d),a=setInterval(T,500),d=setInterval(b,1e3),document.getElementById("timer").innerText=m+"s FEVER!",document.getElementById("timer").style.color="#FFD700";let e=document.createElement("div");e.id="fever-notice",e.innerText="FEVER MODE! +20 points per hit!",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.backgroundColor="#FFD700",e.style.color="#000",e.style.padding="20px",e.style.borderRadius="10px",e.style.fontSize="24px",e.style.fontWeight="bold",e.style.zIndex="10000",e.style.boxShadow="0 0 20px rgba(255, 215, 0, 0.8)",document.body.appendChild(e),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},3e3)}function _(){a&&clearInterval(a),d&&clearInterval(d),u&&clearInterval(u),t&&(t.innerHTML=""),r&&(r.innerHTML=""),t=null,r=null,g=!1,f=!1,h=!1,I=!1,o=0,m=30,document.getElementById("score").innerText=o.toString(),document.getElementById("timer").innerText=m+"s",document.getElementById("timer").style.color="#e52521",document.getElementById("startBtn").disabled=!1,document.getElementById("restartBtn").disabled=!0,document.getElementById("add-score").style.display="none";let e=document.getElementById("fever-notice");e&&e.parentNode.removeChild(e)}function G(){a&&clearInterval(a),d&&clearInterval(d),u&&clearInterval(u),f=!0,B=o,document.getElementById("score").innerText="FINAL SCORE: "+o.toString(),document.getElementById("restartBtn").disabled=!1,I||(document.getElementById("add-score").style.display="block",document.getElementById("player-name").focus())}function N(){document.getElementById("save-score").addEventListener("click",O),v.collection("leaderboard").orderBy("score","desc").limit(10).onSnapshot(e=>{const n=[];e.forEach(i=>{n.push(i.data())}),H(n)},e=>{console.error("Error listening to leaderboard:",e)})}function H(e){const n=document.getElementById("leaderboard-body");n.innerHTML="";for(let i=0;i<Math.min(e.length,10);i++){const p=document.createElement("tr");p.innerHTML=`
            <td>${i+1}</td>
            <td>${e[i].name}</td>
            <td>${e[i].score}</td>
        `,n.appendChild(p)}}function O(){const e=document.getElementById("player-name"),n=e.value.trim();if(n===""){alert("Please enter your name");return}if(I){alert("Score already saved!");return}v.collection("leaderboard").add({name:n,score:B,timestamp:firebase.firestore.FieldValue.serverTimestamp()}).then(()=>{I=!0,document.getElementById("add-score").style.display="none",e.value="",alert("Score saved to global leaderboard!")}).catch(i=>{console.error("Error saving score to Firestore:",i),alert("Failed to save score. Please check Firestore security rules.")})}
